% Appendix C

\chapter{Proof of proposition \ref{rho}} % Main appendix title

\label{Appendix_C} % For referencing this appendix elsewhere, use \ref{AppendixA}
\begin{prop*}
  The social efficient goal of $\max_{i,j}x_{ij}v_{ij}(s)$ can be ex post implemented if:
  
For all $i$ and $j$,
$$v_{ij}(s)=b_{ij} + o_i(s_i) + \sum_{l \not = i} r_l(s_l) $$
where $b_{ij}>0$ is the base value, $s_i \in [0, + \infty)$, $\forall i,o_i(0)=r_i(0)=0$

Further assumptions are listed below.

(i)For all $i$, $\frac{\partial o_i}{\partial s_i} > 0$, $\frac{\partial r_i}{\partial s_i} > 0$;

(ii) $\forall i, \frac{\partial o_i}{\partial s_i}
> \frac{\partial r_i}{\partial s_i} > 0$;

%(iii)Faced with a $s_{-i}$, as the $s_i$ increases, agent $i$ will finally get some good allocated in the solution of the assignment problem.
\end{prop*}

\begin{proof}
  We need to show that the assumptions imply Condition $\rho$, that is, from the maximizing solution $x$s to  $\sum_{ij}x_{ij}v_{ij}(s)$, one can designate an allocation scheme satisfying
  if $v_{ik}(s_i) < v_{ik}(s_i^*)$, agent $i$ will have no probability to be allocated the good $k$. %in all the maximizing allocation schemes.

  if $v_{ik}(s_i) > v_{ik}(s_i^*)$, agent $i$ will have a probability to be allocated the certain good $k$ and charged $ v_{ik}(s_i^*)$. However, the probability does not depend on $s_i$.

  The wanted allocation scheme under the propostion's environment: Randomly pick an integer solution matrix $x$ of  the assignment maximization problem \footnote{By Dantzig's linear programming theory, such a solution exists.} 
 $$\max_{i,j}x_{ij}v_{ij}(s)$$
 s.t.
 $$\sum_i x_{ij} \leq 1\ for\ all\ j $$
 $$\sum_j x_{ij} \leq 1\ for\ all\ i $$
 $$x_{ij} \geq 0\ for\ all\ i,j $$

 Then assign the goods according to the matrix $x$ such that if $x_{ij}=1$, agent $i$ is assigned good $j$, and $i$ is
 charged $v_{ij}(s_i^*(s_{-i}), s_{-i})$.


 Now we need to check that this scheme satisfy the two requirements in Condition $\rho$ to complete the proof. Let us show two useful properties.

 First, we assert that whenever agent $i$ is never allocated the good $k$ in any maximizing solution $x$s to  $\sum_{ij}x_{ij}v_{ij}(s)$ under the reported profile $(s_i,s_{-i})$, then agent $i$ is never allocated the good $k$ in any maximizing solution $x'$s to  $\sum_{ij}x_{ij}'v_{ij}(s_i', s_{-i})$ under the reported profile $(s_i',s_{-i})$ if $s_i' < s_i$. Suppose not, then there is an $\hat{x}$ allocating $k$ to $i$ such that $\sum_{ij}\hat{x}_{ij}v_{ij}(s_i', s_{-i}) \geq \sum_{ij}x_{ij}v_{ij}(s_i',s_{-i})$. Notice that $s_i$ influence $v_{ij}$ only through $o_i(s_i)$ for all $j \in \{1,\cdots,n\}$;for all other agent $l \not = i$, $s_i$ influence $v_{lj}$ only through $r_i(s_i)$. Furthermore, $\frac{\partial o_i}{\partial s_i}> \frac{\partial r_i}{\partial s_i} > 0$. Thus $\sum_{ij}\hat{x}_{ij}v_{ij}(s_i, s_{-i}) \geq \sum_{ij}x_{ij}v_{ij}(s_i,s_{-i})$ as the increase from $s_i'$ to $s_i$ add to the left hand side at least as much as the right hand side\footnote{Note that all $n$ goods are allocated in any maximizing scheme}. So $\hat{x}$ is also a maximizing scheme. Contrary to  maximizing solution never allocate $k$ to $i$.

 Second, we assert that whenever agent $i$ is allocated the good $k$ in a integer maximizing solution $x$s to  $\sum_{ij}x_{ij}v_{ij}(s)$ under the reported profile $(s_i,s_{-i})$, then agent $i$ must also be allocated the good $k$ in some maximizing solution $x'$s to  $\sum_{ij}x_{ij}'v_{ij}(s_i', s_{-i})$ under the reported profile $(s_i',s_{-i})$ if $s_i' > s_i$. Suppose not, then there is a $\tilda{x}$ not allocating $k$ to $i$ such that $\sum_{ij}\hat{x}_{ij}v_{ij}(s_i', s_{-i}) > \sum_{ij}x_{ij}v_{ij}(s_i',s_{-i})$. Notice that $s_i$ influence $v_{ij}$ only through $o_i(s_i)$ for all $j \in \{1,\cdots,n\}$;for all other agent $l \not = i$, $s_i$ influence $v_{lj}$ only through $r_i(s_i)$. Furthermore, $\frac{\partial o_i}{\partial s_i}> \frac{\partial r_i}{\partial s_i} > 0$. Thus $\sum_{ij}\hat{x}_{ij}v_{ij}(s_i, s_{-i}) > \sum_{ij}x_{ij}v_{ij}(s_i,s_{-i})$ as the decrease from $s_i'$ to $s_i$ reduce the right hand side at least as much as the right hand side. This is contrary to  that $x$ maximizes $\sum_{ij}x_{ij}v_{ij}(s)$.
 
 From these two properties, we have for each agent good pair $(i,j)$ a particular $s_i=s_i(j)$ such that when $s_i < s_i(j)$, $x_{ij}=1$ never hold for any integer maximizing solution $x$s to  $\sum_{ij}x_{ij}v_{ij}(s)$; when $s_i > s_i(j)$, $x_{ij}=1$ hold for some integer maximizing solution $x$s to  $\sum_{ij}x_{ij}v_{ij}(s)$.\footnote{when $j$ is never allocated to $i$ in a integer maximizing solution, let $s_i(j)=0$; When $j$ is always allocated to $i$ in some integer maximizing solution, let $s_i(j)=+\infty$.}

 A notational declaration: all the $x$ in the following part is integral.

 Now we claim that for any $i$, $s_i(j)=s_i(j')$ for all $j, j'$ if neither is $+\infty$.  Suppose not, then as $s_i$ increases from $0$ to $+\infty$, after we pass the first
 $s_i(j),j \in \{1,\cdots,n\}$, we will meet a second $s_i(j'), j' \in \{1,\cdots,n\}$, the set $\{j \in  \{1,\cdots,n\}| x_{ij}=1, x\ maximizes \sum_{ij}x_{ij}v_{ij}(s_i,s_{-i})\}$ increases. Let $x'$ denote the integer solution to $\max_x\sum_{ij}x_{ij}v_{ij}(s_i,s_{-i})$
 such that $x_{ij'}=1$ when $s_i > s_i(j')$. Then for any other assignment $x$, $x'_{ij}v_{ij}(s_i,s_{-i}) \geq x_{ij}v_{ij}(s_i,s_{-i})$. Consider $s_i$ decreases to  $s_i < s_i(j')$. Since  $s_i$ influence $v_{ij}$ only through $o_i(s_i)$ for all $j \in \{1,\cdots,n\}$,for all other agent $l \not = i$, $s_i$ influence $v_{lj}$ only through $r_i(s_i)$,and $\frac{\partial o_i}{\partial s_i}> \frac{\partial r_i}{\partial s_i} > 0$, it is still the case that $x'_{ij}v_{ij}(s_i,s_{-i}) \geq x_{ij}v_{ij}(s_i,s_{-i})$  as the decrease from $s_i'$ to $s_i$ reduce the right hand side at least as much as the right hand side. But it's contrary to the description of $s_i(j')$ which says that if $s_i < s_j(j')$,  $x_{ij}=1$ never hold for any integer maximizing solution $x$s to  $\sum_{ij}x_{ij}v_{ij}(s)$.

 Let $s_i^*$ be the value that all $s_i(j)$ which is not $\infty$ equal to. Then the sets $\{j \in  \{1,\cdots,n\}| x_{ij}=1, x\ maximizes \sum_{ij}x_{ij}v_{ij}(s_i,s_{-i})\}$ and $\{x| x\ maximizies \sum_{ij}x_{ij}v_{ij}(s_i,s_{-i})\}$ stay the same for any $s_i > s_i^*$.\footnote{The fact that$\{x| x\ maximizes \sum_{ij}x_{ij}v_{ij}(s_i,s_{-i})\}$ stays the same for any $s_i > s_i^*$ has not been shown explicitly yet. However, it is easy to show its truthfulness by the method of ``reduction to absurdity'' like the previous paragraphs.}
 
 We can see that Condition $\rho$ holds,because for any $i$,$k$,
 
 if $v_{ik}(s_i) < v_{ik}(s_i^*)$,  since $s_i$ influences $v_{ik}(s_i)$ only through $o_{i}(s_i)$ and  $\frac{\partial o_i}{\partial s_i} > 0$, $s_i < s_i*$. According to $s_i*$'s definition, agent $i$ will have no probability to be allocated the good $k$. %in all the maximizing allocation schemes.

 if $v_{ik}(s_i) > v_{ik}(s_i^*)$, then $s_i > s_i^*$, agent $i$ will have a probability to be allocated the certain good $k$ and charged $ v_{ik}(s_i^*)$. However, the probability does not rely on $s_i$ for it is a fixed value for all $s_i > s_i^*$,  $|\{x | x_{ij}=1,x\ maximizes
\sum_{ij}x_{ij}v_{ij}(s_i,s_{-i}) \}|/|\{x| x\ maximizes \sum_{ij}x_{ij}v_{ij}(s_i,s_{-i}) \}|$  .
 


\end{proof}